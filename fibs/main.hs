-- Fibonacci numbers 
-- For positive n fibonacci(n)=fibonacci(n-1)+fibonacci(n-2)
-- For negative n fibonacci(n)=fibonacci(n+2)-fibonacci(n+1)
-- Example:
-- *Main> fibonacci 10
-- 55
-- *Main> fibonacci (-10)
-- -55
-- *Main> :set +s
-- (0.01 secs, 0 bytes)
-- *Main> fibonacci 3000
-- 410615886307971260333568378719267105220125108637369252408885430926905584274113403731330491660850044560830036835706942274588569362145476502674373045446852160486606292497360503469773453733196887405847255290082049086907512622059054542195889758031109222670849274793859539133318371244795543147611073276240066737934085191731810993201706776838934766764778739502174470268627820918553842225858306408301661862900358266857238210235802504351951472997919676524004784236376453347268364152648346245840573214241419937917242918602639810097866942392015404620153818671425739835074851396421139982713640679581178458198658692285968043243656709796000
-- (0.02 secs, 9,003,408 bytes)
--
-- https://en.wikipedia.org/wiki/Fibonacci_number
fibonacci n | n == 0    = 0
            | n == 1    = 1
            | n == -1    = 1
            | n > 0     = helper (n - 2) 0 1
            | otherwise = helper1 (n + 2) 0 1


helper 0 a b = a + b
helper n a b = helper (n - 1) b (a + b)

helper1 0 a b = a - b
helper1 n a b = helper1 (n + 1) b (a - b)
